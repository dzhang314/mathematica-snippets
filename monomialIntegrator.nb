(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9371,        250]
NotebookOptionsPosition[      8911,        230]
NotebookOutlinePosition[      9285,        246]
CellTagsIndexPosition[      9242,        243]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"pic", "[", 
   RowBox[{"dim_Integer", ",", "deg_Integer"}], "]"}], ":=", 
  RowBox[{"ArrayPlot", "@", 
   RowBox[{"Outer", "[", 
    RowBox[{"Coefficient", ",", "\[IndentingNewLine]", 
     RowBox[{"sphericalHarmonicW", "@@@", 
      RowBox[{"sphericalHarmonicRange", "[", 
       RowBox[{"dim", ",", "deg"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"monomials", "[", 
      RowBox[{
       RowBox[{"dim", "+", "1"}], ",", "deg"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.688888362366279*^9, 3.688888363518322*^9}, {
  3.6888884797783456`*^9, 3.688888490639971*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "10", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6888921318536043`*^9, 3.6888921358636017`*^9}, {
  3.6888927001897507`*^9, 3.68889270067303*^9}, {3.688893409175606*^9, 
  3.688893409281682*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "@", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"$snippetDirectory", ",", "\"\<harmonicPolynomials.wl\>\""}], 
        "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"inds", "=", 
      RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sphHarms", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ostr", "=", 
      RowBox[{"OpenWrite", "[", 
       RowBox[{
        RowBox[{"\"\<sphericalHarmonicW_\>\"", "<>", 
         RowBox[{"ToString", "[", "deg", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"PageWidth", "\[Rule]", "Infinity"}], ",", 
        RowBox[{"FormatType", "\[Rule]", "OutputForm"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "@", 
      RowBox[{"DeleteFile", "[", "fname", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PutAppend", "[", 
         RowBox[{
          RowBox[{"Compress", "[", 
           RowBox[{"sphericalHarmonicW", "@@", 
            RowBox[{"Prepend", "[", 
             RowBox[{"inds", ",", "deg"}], "]"}]}], "]"}], ",", "ostr"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"Max", "@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "inds"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "inds", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
              "\[NotEqual]", "0"}], "&"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", "i", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"inds", "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"deg", "-", "1"}], ",", 
               RowBox[{"Length", "@", "inds"}]}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{"1", ",", 
               RowBox[{"deg", "-", "1"}]}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"--", 
            RowBox[{
            "inds", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "inds", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
              "=", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", 
                 RowBox[{"Length", "@", "inds"}]}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{
                  "inds", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", "1"}], "]"}], ",", 
                RowBox[{
                "inds", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"Length", "@", "inds"}]}], "}"}]}], "]"}]}]}], 
         "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"deg", ",", "11", ",", "20"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6888920604710493`*^9, 3.6888920810763965`*^9}, {
   3.688892137293222*^9, 3.688892219939909*^9}, {3.688892430372347*^9, 
   3.6888924309305615`*^9}, {3.6888925091242504`*^9, 3.688892525787402*^9}, {
   3.6888925733744726`*^9, 3.6888925958429193`*^9}, {3.688892680017508*^9, 
   3.6888926861649776`*^9}, 3.6888929580954556`*^9, {3.6888930311820993`*^9, 
   3.688893056841849*^9}, {3.6888931874620733`*^9, 3.6888931920706444`*^9}, {
   3.6888934180734386`*^9, 3.6888934185860877`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.688892628842077*^9, 3.688892764104673*^9, 
  3.688893174513688*^9, 3.688893355110427*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "hzz", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hzz", "[", "m_Integer", "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{"\[FormalX]","1"},
       "IndexedDefault"], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Sign", "[", "m", "]"}], 
       TemplateBox[{"\[FormalX]","2"},
        "IndexedDefault"]}]}], ")"}], 
    RowBox[{"Abs", "[", "m", "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hzz", "[", 
    RowBox[{"deg_Integer", ",", "m_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"generalHarmonicPart", "[", 
     RowBox[{"3", ",", "deg"}], "]"}], "/.", "\[IndentingNewLine]", 
    RowBox[{"\[FormalA]", "\[Rule]", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"hzz", "[", "m", "]"}], 
        SuperscriptBox[
         TemplateBox[{"\[FormalX]","3"},
          "IndexedDefault"], 
         RowBox[{"deg", "-", 
          RowBox[{"Abs", "[", "m", "]"}]}]]}], ",", 
       RowBox[{"monomials", "[", 
        RowBox[{"3", ",", "deg"}], "]"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hzz", "[", 
    RowBox[{"deg_Integer", ",", "j_Integer", ",", 
     RowBox[{"m", " ", ":", " ", 
      RowBox[{"_Integer", ".."}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "m", "}"}], "]"}], "+", "3"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"generalHarmonicPart", "[", 
       RowBox[{"d", ",", "deg"}], "]"}], "/.", "\[IndentingNewLine]", 
      RowBox[{"\[FormalA]", "\[Rule]", 
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"hzz", "[", 
           RowBox[{"j", ",", "m"}], "]"}], 
          SuperscriptBox[
           TemplateBox[{"\[FormalX]","d"},
            "IndexedDefault"], 
           RowBox[{"deg", "-", "j"}]]}], ",", 
         RowBox[{"monomials", "[", 
          RowBox[{"d", ",", "deg"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.688834912631219*^9, 3.6888349371962366`*^9}, {
   3.688835167517253*^9, 3.6888351826784735`*^9}, {3.688835610792137*^9, 
   3.688835744416182*^9}, {3.6888359384934936`*^9, 3.6888359903109565`*^9}, {
   3.688836026629053*^9, 3.6888360421980457`*^9}, {3.6888360807092705`*^9, 
   3.688836085112568*^9}, {3.6888367554455285`*^9, 3.688836755730137*^9}, {
   3.68883680945516*^9, 3.688836827621189*^9}, {3.6888369235709543`*^9, 
   3.688836999422223*^9}, {3.6888370339357667`*^9, 3.688837040441042*^9}, {
   3.6888401318533587`*^9, 3.6888401446455426`*^9}, {3.68884257763002*^9, 
   3.688842577986412*^9}, {3.688882783072875*^9, 3.688882785212044*^9}, {
   3.6888830292878036`*^9, 3.688883030981387*^9}, {3.6888834143992033`*^9, 
   3.6888834374257107`*^9}, 3.688883629762048*^9, 3.6888837312425795`*^9, {
   3.688892288075703*^9, 3.688892304305062*^9}}]
},
WindowSize->{1500, 927},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.4 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 624, 14, 97, "Input"],
Cell[1185, 36, 335, 7, 70, "Input"],
Cell[CellGroupData[{
Cell[1545, 47, 4157, 98, 448, "Input"],
Cell[5705, 147, 146, 2, 41, "Output"]
}, Open  ]],
Cell[5866, 152, 3041, 76, 211, "Input"]
}
]
*)

